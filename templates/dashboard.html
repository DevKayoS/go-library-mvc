{{define "dashboard"}}
<div class="content">
    <div class="section-header">
        <h2 class="section-title">ðŸ“Š Dashboard - VisÃ£o Geral</h2>
        <div style="display: flex; gap: 10px;">
            <a href="/books" class="btn btn-primary">ðŸ“– Gerenciar Livros</a>
            <a href="/users" class="btn btn-primary">ðŸ‘¥ Gerenciar UsuÃ¡rios</a>
            <a href="/loans" class="btn btn-primary">ðŸ”„ Gerenciar EmprÃ©stimos</a>
        </div>
    </div>

    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-number">{{.Stats.TotalBooks}}</div>
            <div class="stat-label">Total de Livros</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{.Stats.TotalUsers}}</div>
            <div class="stat-label">Total de UsuÃ¡rios</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{.Stats.TotalLoans}}</div>
            <div class="stat-label">Total de EmprÃ©stimos</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{.Stats.ActiveLoans}}</div>
            <div class="stat-label">EmprÃ©stimos Ativos</div>
        </div>
    </div>

    <div class="grid grid-2">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">ðŸ“š Livros DisponÃ­veis ({{.Stats.AvailableBooks}})</h3>
                <a href="/books" class="btn btn-primary btn-sm">Ver Todos</a>
            </div>
            {{if .Books}}
            {{$hasAvailable := false}}
            {{range .Books}}
            {{if gt .Quantity 0}}
            {{$hasAvailable = true}}
            <div style="padding: 10px 0; border-bottom: 1px solid #e9ecef;">
                <strong>{{.Title}}</strong> por {{.Author}}
                <br><small>Quantidade: {{.Quantity}}</small>
            </div>
            {{end}}
            {{end}}
            {{if not $hasAvailable}}
            <p style="text-align: center; color: #6c757d; padding: 20px;">Nenhum livro disponÃ­vel no momento.</p>
            {{end}}
            {{else}}
            <p style="text-align: center; color: #6c757d; padding: 20px;">Nenhum livro cadastrado.</p>
            {{end}}
        </div>

        <div class="card">
            <div class="card-header">
                <h3 class="card-title">ðŸ‘¥ UsuÃ¡rios Cadastrados</h3>
                <a href="/users" class="btn btn-primary btn-sm">Ver Todos</a>
            </div>
            {{if .Users}}
            {{range .Users}}
            <div style="padding: 10px 0; border-bottom: 1px solid #e9ecef;">
                <strong>{{.Name}}</strong>
                <br><small>{{.Email}}</small>
            </div>
            {{end}}
            {{else}}
            <p style="text-align: center; color: #6c757d; padding: 20px;">Nenhum usuÃ¡rio cadastrado.</p>
            {{end}}
        </div>
    </div>

    <div class="card" style="margin-top: 20px;">
        <div class="card-header">
            <h3 class="card-title">ðŸ”„ EmprÃ©stimos Ativos</h3>
            <a href="/loans" class="btn btn-primary btn-sm">Ver Todos</a>
        </div>
        {{if .Loans}}
        {{$hasActive := false}}
        {{range .Loans}}
        {{if eq .Status "active"}}
        {{$hasActive = true}}
        <div
            style="padding: 15px; border: 1px solid #e9ecef; border-radius: 8px; margin-bottom: 10px; background: #f8f9fa;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <strong>EmprÃ©stimo #{{.ID}}</strong>
                    <br><small>Livro ID: {{.BookID}} | UsuÃ¡rio ID: {{.UserID}}</small>
                    <br><small>Emprestado em: {{.BorrowedAt.Format "02/01/2006 15:04"}}</small>
                </div>
                <form action="/loans/{{.ID}}/return" method="POST" style="display: inline;">
                    <button type="submit" class="btn btn-success btn-sm">ðŸ“š Devolver</button>
                </form>
            </div>
        </div>
        {{end}}
        {{end}}
        {{if not $hasActive}}
        <p style="text-align: center; color: #6c757d; padding: 20px;">Nenhum emprÃ©stimo ativo no momento.</p>
        {{end}}
        {{else}}
        <p style="text-align: center; color: #6c757d; padding: 20px;">Nenhum emprÃ©stimo registrado.</p>
        {{end}}
    </div>

    <div class="card" style="margin-top: 20px;">
        <div class="card-header">
            <h3 class="card-title">âš¡ AÃ§Ãµes RÃ¡pidas</h3>
        </div>
        <div style="display: flex; gap: 15px; flex-wrap: wrap;">
            <button class="btn btn-primary" onclick="document.getElementById('addBookModal').style.display='block'">
                âž• Adicionar Livro
            </button>
            <button class="btn btn-primary" onclick="document.getElementById('addUserModal').style.display='block'">
                âž• Adicionar UsuÃ¡rio
            </button>
            <button class="btn btn-primary" onclick="document.getElementById('addLoanModal').style.display='block'">
                âž• Novo EmprÃ©stimo
            </button>
        </div>
    </div>
</div>
{{end}}